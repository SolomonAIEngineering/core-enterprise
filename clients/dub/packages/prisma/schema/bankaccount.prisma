enum AccountType {
  depository
  credit
  other_asset
  loan
  other_liability
}

enum ConnectionStatus {
  disconnected
  connected
  unknown
}

enum BankProvider {
  gocardless
  plaid
  teller
  stripe
}

model BankAccount {
  id               String       @id @default(cuid())
  accountId        String
  accountReference String?
  balance          Float?
  bankConnectionId String?
  baseBalance      Float?
  baseCurrency     String?
  createdAt        DateTime   @default(now())
  createdBy        String
  currency         String?
  enabled          Boolean      @default(true)
  errorDetails     String?
  errorRetries     Int?
  manual           Boolean?
  name             String?
  projectId        String
  type             AccountType?
  bankConnection   BankConnection? @relation(fields: [bankConnectionId], references: [id])
  creator          User         @relation(fields: [createdBy], references: [id])
  project          Project         @relation(fields: [projectId], references: [id])
  transactions     Transaction[]

  @@index([bankConnectionId])
  @@index([createdBy])
  @@index([projectId])
}

model BankConnection {
  id            String            @id @default(cuid())
  accessToken   String?
  createdAt     DateTime
  enrollmentId  String?
  errorDetails  String?
  errorRetries  Int?
  expiresAt     DateTime?
  institutionId String
  lastAccessed  DateTime?
  logoUrl       String?
  name          String
  provider      BankProvider?
  referenceId   String?
  status        ConnectionStatus?
  projectId     String
  bankAccounts  BankAccount[]
  project       Project              @relation(fields: [projectId], references: [id])

  @@index([projectId])
}
